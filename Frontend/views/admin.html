<!--
* Project: Online Course Platform
* File: admin.html
* Description: Final corrected version with no duplicate modals.
-->
<div class="container-fluid py-5">
    <h1 class="mb-4">Admin Dashboard</h1>

    <div class="row">
        <!-- Sidebar Navigation for Admin -->
        <div class="col-lg-3">
            <div class="list-group">
                <a href="#admin-dashboard-main" class="list-group-item list-group-item-action active" data-bs-toggle="tab">
                    <i class="bi bi-speedometer2 me-2"></i> Overview
                </a>
                <a href="#admin-manage-courses" class="list-group-item list-group-item-action" data-bs-toggle="tab">
                    <i class="bi bi-book me-2"></i> Manage Courses
                </a>
                <a href="#admin-manage-users" class="list-group-item list-group-item-action" data-bs-toggle="tab">
                    <i class="bi bi-people me-2"></i> Manage Users
                </a>
                <a href="#admin-manage-instructors" class="list-group-item list-group-item-action" data-bs-toggle="tab">
                    <i class="bi bi-person-video3 me-2"></i> Manage Instructors
                </a>
                <a href="#admin-manage-enrollments" class="list-group-item list-group-item-action" data-bs-toggle="tab">
                    <i class="bi bi-person-check me-2"></i> Manage Enrollments
                </a>
            </div>
        </div>

        <!-- Main Content Area for Admin -->
        <div class="col-lg-9">
            <div class="tab-content">

                <!-- Overview Tab -->
                <div class="tab-pane fade show active" id="admin-dashboard-main">
                    <h2>Platform Overview</h2>
                    <div class="row mt-4">
                        <div class="col-md-4">
                            <div class="card text-white bg-primary mb-3">
                                <div class="card-body">
                                    <h5 class="card-title">Total Users</h5>
                                    <p class="card-text fs-2" id="total-users-count">...</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card text-white bg-success mb-3">
                                <div class="card-body">
                                    <h5 class="card-title">Total Courses</h5>
                                    <p class="card-text fs-2" id="total-courses-count">...</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card text-white bg-info mb-3">
                                <div class="card-body">
                                    <h5 class="card-title">Total Enrollments</h5>
                                    <p class="card-text fs-2" id="total-enrollments-count">...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manage Courses Tab -->
                <div class="tab-pane fade" id="admin-manage-courses">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>Manage Courses</h2>
                        <button class="btn btn-success" onclick="CourseActions.openAddModal()"><i class="bi bi-plus-lg me-2"></i>Add New Course</button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead><tr><th>ID</th><th>Title</th><th>Instructor ID</th><th>Price</th><th>Actions</th></tr></thead>
                            <tbody id="courses-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Manage Users Tab -->
                <div class="tab-pane fade" id="admin-manage-users">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>Manage Users</h2>
                        <button class="btn btn-success" onclick="UserActions.openAddModal()"><i class="bi bi-plus-lg me-2"></i>Add New User</button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead><tr><th>ID</th><th>Username</th><th>Email</th><th>Role</th><th>Actions</th></tr></thead>
                            <tbody id="users-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Manage Instructors Tab -->
                <div class="tab-pane fade" id="admin-manage-instructors">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>Manage Instructors</h2>
                        <button class="btn btn-success" onclick="InstructorActions.openAddModal()"><i class="bi bi-plus-lg me-2"></i>Add New Instructor</button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead><tr><th>Instructor ID</th><th>User ID</th><th>Name</th><th>Expertise</th><th>Actions</th></tr></thead>
                            <tbody id="instructors-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Manage Enrollments Tab -->
                <div class="tab-pane fade" id="admin-manage-enrollments">
                    <h2>Manage Enrollments</h2>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead><tr><th>Enrollment ID</th><th>User ID</th><th>Course ID</th><th>Enrollment Date</th><th>Progress</th><th>Actions</th></tr></thead>
                            <tbody id="enrollments-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MODALS FOR CRUD OPERATIONS - Place them once at the end -->

<!-- Add/Edit User Modal -->
<div class="modal fade" id="userModal" tabindex="-1">
  <div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="userModalLabel">Add/Edit User</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="userForm"><input type="hidden" id="userId" name="id"><div class="mb-3"><label for="username" class="form-label">Username</label><input type="text" class="form-control" id="username" name="username" required></div><div class="mb-3"><label for="email" class="form-label">Email address</label><input type="email" class="form-control" id="email" name="email" required></div><div class="mb-3"><label for="firstName" class="form-label">First Name</label><input type="text" class="form-control" id="firstName" name="first_name"></div><div class="mb-3"><label for="lastName" class="form-label">Last Name</label><input type="text" class="form-control" id="lastName" name="last_name"></div><div class="mb-3"><label for="role" class="form-label">Role</label><select class="form-select" id="role" name="role"><option value="user">User</option><option value="admin">Admin</option></select></div><div class="mb-3" id="password-field-container"><label for="password" class="form-label">Password</label><input type="password" class="form-control" id="password" name="password"></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button><button type="submit" form="userForm" class="btn btn-primary">Save changes</button></div></div></div>
</div>

<!-- Add/Edit Course Modal -->
<div class="modal fade" id="courseModal" tabindex="-1">
  <div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="courseModalLabel">Add/Edit Course</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="courseForm"><input type="hidden" id="courseId" name="id"><div class="mb-3"><label for="courseTitle" class="form-label">Title</label><input type="text" class="form-control" id="courseTitle" name="title" required></div><div class="mb-3"><label for="courseDescription" class="form-label">Description</label><textarea class="form-control" id="courseDescription" name="description" rows="3"></textarea></div><div class="mb-3"><label for="courseInstructorId" class="form-label">Instructor ID</label><input type="number" class="form-control" id="courseInstructorId" name="instructor_id" required></div><div class="row"><div class="col-md-6 mb-3"><label for="coursePrice" class="form-label">Price</label><input type="number" step="0.01" class="form-control" id="coursePrice" name="price" required></div><div class="col-md-6 mb-3"><label for="courseDifficulty" class="form-label">Difficulty Level</label><select class="form-select" id="courseDifficulty" name="difficulty_level"><option value="Beginner">Beginner</option><option value="Intermediate">Intermediate</option><option value="Advanced">Advanced</option></select></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button><button type="submit" form="courseForm" class="btn btn-primary">Save changes</button></div></div></div>
</div>

<!-- Add/Edit Instructor Modal -->
<div class="modal fade" id="instructorModal" tabindex="-1">
  <div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="instructorModalLabel">Add/Edit Instructor</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="instructorForm"><input type="hidden" id="instructorId" name="id"><div class="mb-3"><label for="instructorUserId" class="form-label">User ID</label><input type="number" class="form-control" id="instructorUserId" name="user_id" required><div class="form-text">This must be the ID of an existing user.</div></div><div class="mb-3"><label for="instructorBio" class="form-label">Bio</label><textarea class="form-control" id="instructorBio" name="bio" rows="3"></textarea></div><div class="mb-3"><label for="instructorExpertise" class="form-label">Expertise</label><input type="text" class="form-control" id="instructorExpertise" name="expertise"></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button><button type="submit" form="instructorForm" class="btn btn-primary">Save changes</button></div></div></div>
</div>